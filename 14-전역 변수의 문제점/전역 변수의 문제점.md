# 지역 변수의 생명 주기

- 지역 변수는 함수가 호출될 때 생성되고, 함수가 종료되면 소멸한다.
- 따라서 함수 실행이 끝나면 해당 변수는 더 이상 참조할 수 없다.
- 지역 변수는 메모리에 잠깐만 존재하므로, 메모리 효율성이 높다.
- 예시:

```js
function foo() {
  var x = "local";
  console.log(x); // 'local'
}
foo();
console.log(x); // ReferenceError
```

# 전역 변수의 생명 주기

- 전역 변수는 코드가 로드될 때부터 프로그램 종료 시점까지 유지된다.
- 따라서 전역 변수는 애플리케이션 전체에서 참조 가능하다.
- 전역 변수는 브라우저 환경에서 **전역 객체(window)**의 프로퍼티가 된다.
- var 키워드로 선언된 전역 변수 → window 객체에 자동 등록.
- 반면 let, const로 선언된 전역 변수는 전역 객체에 등록되지 않는다.

## 전역 변수의 문제점

### 1. 암묵적 결합 (Implicit Coupling)

- 모든 코드가 전역 변수를 참조·변경할 수 있어 코드의 의도치 않은 상태 변경 위험이 커진다.

### 2. 긴 생명 주기

- 메모리를 오랫동안 점유하고, 상태 변경 기회가 많아 예기치 못한 부작용이 생길 수 있다.

### 3. 스코프 체인 상에서 가장 마지막에 검색됨

- 지역 변수가 없을 때 마지막으로 전역 변수를 찾기 때문에, 검색 속도가 상대적으로 느림.

### 4. 네임스페이스 오염

- 하나의 전역 스코프를 여러 파일이 공유하기 때문에, 같은 이름의 전역 변수 충돌 가능성이 있다.

## 전역 변수 사용 억제 방법

### **즉시 실행 함수(IIFE)** 로 감싸서 지역 스코프를 만들어 사용.

- 네임스페이스 객체를 만들어 전역 변수 사용 최소화.
- **모듈 패턴(ES6 모듈)** 을 통해 모듈 스코프 활용 → 전역 변수 의존 줄이기.
- 지역 변수는 짧은 생명 주기 + 메모리 효율적, 함수 실행 동안만 유지됨.
- 전역 변수는 긴 생명 주기 + 전역 객체에 속함, 관리하기 어렵고 오류 가능성 높음.
- 따라서 전역 변수는 최소화하고, 모듈이나 지역 스코프를 활용하는 것이 권장됨.

### 네임스페이스 객체

- 전역 변수를 직접 선언하지 않고, 전역에 객체를 하나 두고 그 안에 필요한 변수/함수를 프로퍼티로 관리.
- 전역 변수 남발을 줄일 수 있으나, 여전히 전역 네임스페이스를 차지하기 때문에 한계 있음.

```js
var MYAPP = {};
MYAPP.name = "Lee";
console.log(MYAPP.name); // Lee

MYAPP.person = {
  name: "Lee",
  address: "Seoul",
};
console.log(MYAPP.person.name); // Lee
```

### 모듈 패턴 (Module Pattern)

- 즉시 실행 함수로 클로저를 활용해 private 변수를 만들고, 필요한 부분만 외부에 공개.
- 정보 은닉(Information Hiding)과 캡슐화(Encapsulation)를 제공.
- public/private 개념을 흉내낼 수 있음.

```js
var Counter = (function () {
  var num = 0; // private 변수
  return {
    increase() {
      return ++num;
    },
    decrease() {
      return --num;
    },
  };
})();

console.log(Counter.num); // undefined (외부 접근 불가)
console.log(Counter.increase()); // 1
console.log(Counter.decrease()); // 0
```

### ES6 모듈 (권장 방식)

- ES6 import/export를 사용하면 파일 단위의 독립된 스코프가 제공됨.
- 더 이상 전역 변수를 오염시키지 않고, 필요한 모듈만 가져와 사용 가능.
- script 태그에 type="module"을 추가해야 동작.
- 모든 최신 브라우저 지원 (단, IE는 지원 X → Babel/Webpack 같은 번들러 필요).

```js
<script type="module" src="lib.mjs"></script>
<script type="module" src="app.mjs"></script>
```

## 정리

- 전역 변수는 코드 충돌, 상태 변경 위험 때문에 지양해야 함.
- 간단히 막으려면 IIFE / 네임스페이스 객체 사용.
- 정보 은닉과 관리가 필요하다면 모듈 패턴.
- 현대 자바스크립트에서는 ES6 모듈을 사용하는 것이 가장 바람직한 해결책.
